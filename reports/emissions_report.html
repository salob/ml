<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ML Model Emissions Report</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/date-fns@2.29.3/index.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .card-title {
            font-size: 0.9em;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
        }

        .card-value {
            font-size: 2em;
            font-weight: bold;
            color: #333;
        }

        .card-unit {
            font-size: 0.8em;
            color: #888;
            margin-left: 5px;
        }

        .chart-container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }

        .chart-title {
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 20px;
            color: #333;
        }

        .chart-wrapper {
            position: relative;
            height: 400px;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }

        .system-info {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
        }

        .system-info h2 {
            margin-bottom: 20px;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .info-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
        }

        .info-label {
            font-size: 0.85em;
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .info-value {
            font-size: 1.1em;
            font-weight: 600;
        }

        footer {
            text-align: center;
            padding: 20px;
            color: #666;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ðŸŒ± ML Model Emissions Report</h1>
            <p class="subtitle">Energy Consumption & Carbon Footprint Analysis</p>
        </header>

        <div class="content">
            <!-- Summary Cards -->
            <div class="summary-cards">
                <div class="card">
                    <div class="card-title">Total Experiments</div>
                    <div class="card-value" id="totalExperiments">0</div>
                </div>
                <div class="card">
                    <div class="card-title">Total Energy</div>
                    <div class="card-value" id="totalEnergy">0</div>
                </div>
                <div class="card">
                    <div class="card-title">Total COâ‚‚ Emissions</div>
                    <div class="card-value" id="totalEmissions">0</div>
                </div>
                <div class="card">
                    <div class="card-title">Total Duration</div>
                    <div class="card-value" id="totalDuration">0</div>
                </div>
            </div>

            <!-- Charts Grid -->
            <div class="grid">
                <div class="chart-container">
                    <div class="chart-title">Average Energy Consumption by Model</div>
                    <div class="chart-wrapper">
                        <canvas id="energyChart"></canvas>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-title">Average COâ‚‚ Emissions by Model</div>
                    <div class="chart-wrapper">
                        <canvas id="emissionsChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="grid">
                <div class="chart-container">
                    <div class="chart-title">Average Training Duration by Model</div>
                    <div class="chart-wrapper">
                        <canvas id="durationChart"></canvas>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-title">Average Power Consumption Breakdown</div>
                    <div class="chart-wrapper">
                        <canvas id="powerChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="grid">
                <div class="chart-container">
                    <div class="chart-title">Logistic Regression - Emissions per Run</div>
                    <div class="chart-wrapper">
                        <canvas id="logregEmissionsChart"></canvas>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-title">CNN - Emissions per Run</div>
                    <div class="chart-wrapper">
                        <canvas id="cnnEmissionsChart"></canvas>
                    </div>
                </div>
        

                <div class="chart-container">
                    <div class="chart-title">Transformer - Emissions per Run</div>
                    <div class="chart-wrapper">
                        <canvas id="transformerEmissionsChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Performance Metrics Section -->
            <h2 style="margin-top: 60px; margin-bottom: 30px; color: #333; font-size: 2em;">Model Performance Metrics</h2>
            
            <!-- Individual Model Performance -->
            <div class="grid">
                <div class="chart-container">
                    <div class="chart-title">Logistic Regression - Test Accuracy & F1 per Run</div>
                    <div class="chart-wrapper">
                        <canvas id="logregPerformanceChart"></canvas>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-title">CNN - Test Accuracy & F1 per Run</div>
                    <div class="chart-wrapper">
                        <canvas id="cnnPerformanceChart"></canvas>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-title">Transformer - Test Accuracy & F1 per Run</div>
                    <div class="chart-wrapper">
                        <canvas id="transformerPerformanceChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Cross-Model Comparison -->
            <h2 style="margin-top: 60px; margin-bottom: 30px; color: #333; font-size: 2em;">Cross-Model Comparison</h2>
            
            <div class="grid">
                <div class="chart-container">
                    <div class="chart-title">Average Test Accuracy Comparison</div>
                    <div class="chart-wrapper">
                        <canvas id="accuracyComparisonChart"></canvas>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-title">Average F1 Score Comparison</div>
                    <div class="chart-wrapper">
                        <canvas id="f1ComparisonChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Emissions vs Performance Correlation -->
            <h2 style="margin-top: 60px; margin-bottom: 30px; color: #333; font-size: 2em;">Emissions vs Performance Analysis</h2>
            
            <div class="grid">
                <div class="chart-container">
                    <div class="chart-title">Emissions vs Test Accuracy</div>
                    <div class="chart-wrapper">
                        <canvas id="emissionsVsAccuracyChart"></canvas>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-title">Emissions vs F1 Score</div>
                    <div class="chart-wrapper">
                        <canvas id="emissionsVsF1Chart"></canvas>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-title">Energy Efficiency (Accuracy per Watt-hour)</div>
                    <div class="chart-wrapper">
                        <canvas id="efficiencyChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- System Info -->
            <div class="system-info">
                <h2>System Information</h2>
                <div class="info-grid">
                    <div class="info-item">
                        <div class="info-label">CPU</div>
                        <div class="info-value" id="cpuModel">-</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">GPU</div>
                        <div class="info-value" id="gpuModel">-</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">CPU Cores</div>
                        <div class="info-value" id="cpuCount">-</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">RAM</div>
                        <div class="info-value" id="ramSize">-</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Location</div>
                        <div class="info-value" id="location">-</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Python Version</div>
                        <div class="info-value" id="pythonVersion">-</div>
                    </div>
                </div>
            </div>
        </div>

        <footer>
            <p>Generated on <span id="reportDate"></span> | Powered by CodeCarbon</p>
        </footer>
    </div>

    <script>
        // CSV Data embedded directly
        const codecarbonCSV = `timestamp,project_name,run_id,duration,emissions_g,energy_consumed_wh,cpu_energy_wh,gpu_energy_wh,ram_energy_wh,experiment_id,emissions_rate,cpu_power,gpu_power,ram_power,water_consumed,country_name,country_iso_code,region,cloud_provider,cloud_region,os,python_version,codecarbon_version,cpu_count,cpu_model,gpu_count,gpu_model,longitude,latitude,ram_total_size,tracking_mode,on_cloud,pue,wue
2025-11-16T19:17:48,IMDB_LogReg,c0ce7ea2-abb7-4de6-81d7-d56c2088ecac,14.76084320800146,0.0069362447183926,0.0238518757187553,0.0161513344739875,8.408579390028414e-05,0.0076164554508674,8f74f3ac-7ddf-48a1-8053-f976e6c5cb1e,4.699084341355708e-07,3.113,0.5952,3.0,0.0,Ireland,IRL,leinster,,,macOS-15.6.1-arm64-arm-64bit-Mach-O,3.13.3,3.0.8,8,Apple M3,1,Apple M3,-6.2923,53.3641,16.0,machine,N,1.0,0.0
2025-11-16T19:18:12,IMDB_LogReg,ee557846-dfd9-4e6d-866f-5e8318aae37a,14.89516412501689,0.0065504814779123,0.0225253399285168,0.0148747516719785,1.028648565839588e-05,0.0076403017708798,8f74f3ac-7ddf-48a1-8053-f976e6c5cb1e,4.397723598701819e-07,2.5361,0.0564,3.0,0.0,Ireland,IRL,leinster,,,macOS-15.6.1-arm64-arm-64bit-Mach-O,3.13.3,3.0.8,8,Apple M3,1,Apple M3,-6.2923,53.3641,16.0,machine,N,1.0,0.0
2025-11-16T19:18:38,IMDB_LogReg,e47b88a8-507e-4538-b41f-5b03a8900385,14.974662374996116,0.0062642534275104,0.021541078824334,0.0140633793683355,2.640296358671751e-05,0.0074512964924118,8f74f3ac-7ddf-48a1-8053-f976e6c5cb1e,4.183235167939539e-07,2.9155,0.0029,3.0,0.0,Ireland,IRL,leinster,,,macOS-15.6.1-arm64-arm-64bit-Mach-O,3.13.3,3.0.8,8,Apple M3,1,Apple M3,-6.2923,53.3641,16.0,machine,N,1.0,0.0
2025-11-16T19:19:02,IMDB_LogReg,964ae125-75a6-4b4c-9900-35f1d1f9592c,14.87754745798884,0.00634982579218,0.0218353391178971,0.014330453785005,2.215779871571188e-05,0.0074827275341764,8f74f3ac-7ddf-48a1-8053-f976e6c5cb1e,4.268059510554888e-07,3.395899999999999,0.1066999999999999,3.0,0.0,Ireland,IRL,leinster,,,macOS-15.6.1-arm64-arm-64bit-Mach-O,3.13.3,3.0.8,8,Apple M3,1,Apple M3,-6.2923,53.3641,16.0,machine,N,1.0,0.0
2025-11-16T19:19:28,IMDB_LogReg,0dd848db-74df-4723-8088-798cd5c52179,14.830427458044142,0.0072118587305124,0.0247996380066106,0.0171898982733077,1.3561224195355962e-06,0.0076083836108834,8f74f3ac-7ddf-48a1-8053-f976e6c5cb1e,4.862879880512585e-07,5.858099999999999,0.0097,3.0,0.0,Ireland,IRL,leinster,,,macOS-15.6.1-arm64-arm-64bit-Mach-O,3.13.3,3.0.8,8,Apple M3,1,Apple M3,-6.2923,53.3641,16.0,machine,N,1.0,0.0
2025-11-16T13:03:44,IMDB_CNN,9c3086b0-6b2c-440d-ae36-88742060c9bb,501.80182712501846,0.2602641825337,0.8949783619048001,0.727761826319,0.0028603952314229,0.1643561403543,b1a5bbb1-bac1-4969-8597-a5a540e7ef9b,5.186592962900849e-07,0.3031,0.0325,3.0,0.0,Ireland,IRL,leinster,,,macOS-15.6.1-arm64-arm-64bit-Mach-O,3.13.3,3.0.8,8,Apple M3,1,Apple M3,-6.2923,53.3641,16.0,machine,N,1.0,0.0
2025-11-16T13:11:04,IMDB_CNN,73b6dabc-0364-45d7-a99a-8883b9d97e30,428.8420513329911,0.2135216457622999,0.7342433787671,0.5879401940628001,0.0033030995994207,0.1430000851048,b1a5bbb1-bac1-4969-8597-a5a540e7ef9b,4.979027711920747e-07,10.172,0.1298,3.0,0.0,Ireland,IRL,leinster,,,macOS-15.6.1-arm64-arm-64bit-Mach-O,3.13.3,3.0.8,8,Apple M3,1,Apple M3,-6.2923,53.3641,16.0,machine,N,1.0,0.0
2025-11-16T13:19:52,IMDB_CNN,d5fec4ae-c1ef-4863-9a94-0324f8a51c43,518.0965781249688,0.2486035334856,0.8548805332976,0.6841453437753,0.0024231082412786,0.168312081281,b1a5bbb1-bac1-4969-8597-a5a540e7ef9b,4.798401378857821e-07,0.4149,0.0120999999999999,3.0,0.0,Ireland,IRL,leinster,,,macOS-15.6.1-arm64-arm-64bit-Mach-O,3.13.3,3.0.8,8,Apple M3,1,Apple M3,-6.2923,53.3641,16.0,machine,N,1.0,0.0
2025-11-16T13:27:21,IMDB_CNN,fdf6a069-3dfc-4255-8643-9c87011bcc97,437.7607762500411,0.2128529898051999,0.7319440511862,0.5872084930364,0.0017140604777074,0.143021497672,b1a5bbb1-bac1-4969-8597-a5a540e7ef9b,4.862312965281108e-07,0.2639999999999999,0.0284,3.0,0.0,Ireland,IRL,leinster,,,macOS-15.6.1-arm64-arm-64bit-Mach-O,3.13.3,3.0.8,8,Apple M3,1,Apple M3,-6.2923,53.3641,16.0,machine,N,1.0,0.0
2025-11-16T13:36:19,IMDB_CNN,dfd1ab19-dd5e-4e0f-8915-3879e1a7f699,527.5626312919776,0.2413167237115,0.8298231588575,0.6585147347432999,0.0025843592882273,0.1687240648259,b1a5bbb1-bac1-4969-8597-a5a540e7ef9b,4.5741815170002116e-07,0.2098,0.0124,3.0,0.0,Ireland,IRL,leinster,,,macOS-15.6.1-arm64-arm-64bit-Mach-O,3.13.3,3.0.8,8,Apple M3,1,Apple M3,-6.2923,53.3641,16.0,machine,N,1.0,0.0
2025-11-16T14:38:29,IMDB_Transformer,4d0b736b-5151-4764-9ed6-7fb918ef835f,3723.101714959019,1.487262954817,5.114296366352099,3.8400768694893,0.023644768009572,1.2505747288532,c3685c4f-39d8-4c14-b23b-ff1ab159ec74,3.994687947528747e-07,0.4929,0.036,3.0,0.0,Ireland,IRL,leinster,,,macOS-15.6.1-arm64-arm-64bit-Mach-O,3.13.3,3.0.8,8,Apple M3,1,Apple M3,-6.2923,53.3641,16.0,machine,N,1.0,0.0
2025-11-16T15:34:12,IMDB_Transformer,86fa3ee1-1d41-424a-81b1-a550b2e7283f,3332.394959957979,1.3367696296355,4.5967903909339,3.4399004378443,0.0206937561685173,1.136196196921,c3685c4f-39d8-4c14-b23b-ff1ab159ec74,4.01143815693563e-07,2.4312,0.0261818181818181,3.0,0.0,Ireland,IRL,leinster,,,macOS-15.6.1-arm64-arm-64bit-Mach-O,3.13.3,3.0.8,8,Apple M3,1,Apple M3,-6.2923,53.3641,16.0,machine,N,1.0,0.0
2025-11-16T16:16:00,IMDB_Transformer,3a7bcbee-c2ec-4dac-b56d-00870d5391d8,2496.916625125042,1.0050991360446,3.4562649749649004,2.5851667666848,0.015087323179784,0.8560108851003,c3685c4f-39d8-4c14-b23b-ff1ab159ec74,4.025361223242086e-07,0.3638,0.0104,3.0,0.0,Ireland,IRL,leinster,,,macOS-15.6.1-arm64-arm-64bit-Mach-O,3.13.3,3.0.8,8,Apple M3,1,Apple M3,-6.2923,53.3641,16.0,machine,N,1.0,0.0
2025-11-16T17:11:08,IMDB_Transformer,19f5f53e-5068-4620-8636-58d893c2b476,3295.24178987497,1.3292931859092,4.5710809164533,3.4199972167976,0.0150542932675885,1.1360294063881,c3685c4f-39d8-4c14-b23b-ff1ab159ec74,4.033977688658909e-07,0.1911999999999999,0.0,3.0,0.0,Ireland,IRL,leinster,,,macOS-15.6.1-arm64-arm-64bit-Mach-O,3.13.3,3.0.8,8,Apple M3,1,Apple M3,-6.2923,53.3641,16.0,machine,N,1.0,0.0
2025-11-16T18:01:10,IMDB_Transformer,c4fc4caf-580b-4a77-9f91-6d2b96667748,2989.738962125033,1.183084154633,4.0683074728188,3.0499390947170997,0.0300997497017883,0.9882686283999,c3685c4f-39d8-4c14-b23b-ff1ab159ec74,3.9571486662239537e-07,0.4266,0.0154,3.0,0.0,Ireland,IRL,leinster,,,macOS-15.6.1-arm64-arm-64bit-Mach-O,3.13.3,3.0.8,8,Apple M3,1,Apple M3,-6.2923,53.3641,16.0,machine,N,1.0,0.0
`;
        const carbontrackerCSV = `timestamp,model_name,duration_seconds,duration_formatted,energy_kwh_raw,energy_wh_raw,co2_g_raw,pue_applied,energy_kwh_adjusted,energy_wh_adjusted,co2_g_adjusted,carbon_intensity_gco2_per_kwh,log_file
2025-11-16T19:17:33,IMDB_Logreg,15,0:00:15,3.3675426e-05,0.0336754259999999,0.009419089945,1.58,2.1313560759493667e-05,0.0213135607594936,0.0059614493322784,279.7,ct_imdb_logreg__49723.584846_2025-11-16T191733Z_carbontracker_output.log
2025-11-16T19:17:57,IMDB_Logreg,15,0:00:15,2.9058513e-05,0.0290585129999999,0.008127729457,1.58,1.839146392405063e-05,0.0183914639240506,0.0051441325677215,279.7,ct_imdb_logreg__49933.124907_2025-11-16T191757Z_carbontracker_output.log
2025-11-16T19:18:23,IMDB_Logreg,16,0:00:16,2.8517083e-05,0.028517083,0.007976290419,1.58,1.8048786708860756e-05,0.0180487867088607,0.0050482850753164,279.7,ct_imdb_logreg__50131.113596_2025-11-16T191823Z_carbontracker_output.log
2025-11-16T19:18:47,IMDB_Logreg,15,0:00:15,2.7158971e-05,0.027158971,0.00759642346,1.58,1.7189222151898732e-05,0.0171892221518987,0.004807862949367,279.7,ct_imdb_logreg__50322.372358_2025-11-16T191847Z_carbontracker_output.log
2025-11-16T19:19:13,IMDB_Logreg,15,0:00:15,2.7384418e-05,0.027384418,0.007659481395,1.58,1.7331910126582277e-05,0.0173319101265822,0.0048477730348101,279.7,ct_imdb_logreg__50501.755072_2025-11-16T191913Z_carbontracker_output.log
2025-11-16T12:55:22,IMDB_Cnn,485,0:08:05,0.002803220874,2.803220874,0.784066989476,1.58,0.0017741904265822,1.7741904265822783,0.4962449300481012,279.7,ct_imdb_cnn__2313.584846_2025-11-16T125522Z_carbontracker_output.log
2025-11-16T13:03:55,IMDB_Cnn,412,0:06:52,0.002272408518,2.272408518,0.63559761635,1.58,0.0014382332392405,1.4382332392405064,0.4022769723734177,279.7,ct_imdb_cnn__6073.124907_2025-11-16T130355Z_carbontracker_output.log
2025-11-16T13:11:14,IMDB_Cnn,502,0:08:22,0.002668042123,2.668042123,0.746257198211,1.58,0.0016886342550632,1.6886342550632911,0.4723146824120253,279.7,ct_imdb_cnn__9557.113596_2025-11-16T131114Z_carbontracker_output.log
2025-11-16T13:20:03,IMDB_Cnn,421,0:07:01,0.002284979454,2.2849794539999997,0.63911373463,1.58,0.0014461895278481,1.446189527848101,0.4045023636898734,279.7,ct_imdb_cnn__13633.372358_2025-11-16T132003Z_carbontracker_output.log
2025-11-16T13:27:31,IMDB_Cnn,510,0:08:30,0.002584216808,2.5842168080000003,0.722811074824,1.58,0.0016355802582278,1.6355802582278482,0.4574753638126582,279.7,ct_imdb_cnn__17129.755072_2025-11-16T132731Z_carbontracker_output.log
2025-11-16T13:36:26,IMDB_Transformer,3692,1:01:32,0.013737246522,13.737246522,3.842337799499,1.58,0.0086944598240506,8.694459824050632,2.4318593667715187,279.7,ct_imdb_transformer__21254.584846_2025-11-16T133626Z_carbontracker_output.log
2025-11-16T14:38:39,IMDB_Transformer,3301,0:55:01,0.012290283478,12.290283478,3.437619081657,1.58,0.0077786604291139,7.778660429113923,2.1757082795297467,279.7,ct_imdb_transformer__46595.124907_2025-11-16T143839Z_carbontracker_output.log
2025-11-16T15:34:23,IMDB_Transformer,2466,0:41:06,0.009137287895,9.137287895,2.555719343435,1.58,0.0057830936044303,5.78309360443038,1.6175438882499995,279.7,ct_imdb_transformer__68997.113596_2025-11-16T153423Z_carbontracker_output.log
2025-11-16T16:16:13,IMDB_Transformer,3265,0:54:25,0.012003514605,12.003514605,3.357409202713,1.58,0.007597161142405,7.597161142405063,2.124942533362658,279.7,ct_imdb_transformer__85181.372358_2025-11-16T161613Z_carbontracker_output.log
2025-11-16T17:11:20,IMDB_Transformer,2961,0:49:21,0.011122446055,11.122446055,3.110972408505,1.58,0.0070395228196202,7.039522819620253,1.968969878800633,279.7,ct_imdb_transformer__6944.755072_2025-11-16T171120Z_carbontracker_output.log
`;
        const logregMetricsCSV = `timestamp,model_type,seed,val_accuracy,val_f1,test_accuracy,test_f1,actual_iterations,max_features,ngram_range,solver,C,max_iter
2025-11-16T19:17:48.871536,LogisticRegression,2025,0.9114,0.9113850240690676,0.9002,0.9001982394969448,6,100000,"(1,2)",liblinear,1.0,1000
2025-11-16T19:18:13.060394,LogisticRegression,2026,0.9114,0.9113850240690676,0.9002,0.9001982394969448,6,100000,"(1,2)",liblinear,1.0,1000
2025-11-16T19:18:39.422318,LogisticRegression,2027,0.9114,0.9113850240690676,0.9002,0.9001982394969448,6,100000,"(1,2)",liblinear,1.0,1000
2025-11-16T19:19:02.768340,LogisticRegression,2028,0.9114,0.9113850240690676,0.9002,0.9001982394969448,6,100000,"(1,2)",liblinear,1.0,1000
2025-11-16T19:19:28.982671,LogisticRegression,2029,0.9114,0.9113850240690676,0.9002,0.9001982394969448,6,100000,"(1,2)",liblinear,1.0,1000
`;
        const cnnMetricsCSV = `timestamp,model_type,seed,val_accuracy,val_f1,test_accuracy,test_f1,total_parameters,embedding_dim,max_length,batch_size,max_epochs,actual_epochs,best_val_loss,early_stopped,max_words,device
2025-11-16T13:03:41.322325,CNN,2025,0.8596,0.8594631958533715,0.8626,0.86244284920865,10072449,100,200,32,25,6,0.3231364018788004,True,100000,cpu
2025-11-16T13:11:01.423818,CNN,2026,0.856,0.8557307589716232,0.847,0.8466612747559359,10072449,100,200,32,25,5,0.3483254171101151,True,100000,cpu
2025-11-16T13:19:49.678838,CNN,2027,0.8514,0.8511594677462566,0.8494,0.8491705884650553,10072449,100,200,32,25,6,0.334618337879515,True,100000,cpu
2025-11-16T13:27:18.722421,CNN,2028,0.8478,0.8477925418345499,0.856,0.8559999769599964,10072449,100,200,32,25,5,0.3624619680225469,True,100000,cpu
2025-11-16T13:36:16.608469,CNN,2029,0.8536,0.8535643634234827,0.8456,0.8455880423379987,10072449,100,200,32,25,6,0.3316479734364588,True,100000,cpu
`;
        const transformerMetricsCSV = `timestamp,model_type,seed,val_accuracy,val_f1,test_accuracy,test_f1,total_parameters,embedding_dim,num_heads,num_layers,hidden_dim,max_length,batch_size,max_epochs,actual_epochs,best_val_loss,early_stopped,max_words,device
2025-11-16T14:38:26.319010,TinyTransformer,2025,0.8368,0.8366327118969825,0.8344,0.8342508257431689,13230721,128,8,3,256,200,32,10,9,0.3842233016992071,True,100000,cpu
2025-11-16T15:34:09.196411,TinyTransformer,2026,0.8474,0.8471529931230065,0.8396,0.8392171051829669,13230721,128,8,3,256,200,32,10,8,0.3744362127154496,True,100000,cpu
2025-11-16T16:15:57.496177,TinyTransformer,2027,0.8314,0.8301961518459733,0.816,0.8147666123744923,13230721,128,8,3,256,200,32,10,6,0.380672952267015,True,100000,cpu
2025-11-16T17:11:05.494884,TinyTransformer,2028,0.8468,0.8467699669135151,0.8432,0.843155732273877,13230721,128,8,3,256,200,32,10,8,0.3604801856218629,True,100000,cpu
2025-11-16T18:01:07.480843,TinyTransformer,2029,0.8362,0.8354255190757497,0.8284,0.8275838786344836,13230721,128,8,3,256,200,32,10,7,0.3701605731799344,True,100000,cpu
`;

        // Parse CSV
        function parseCSV(csv) {
            if (!csv || csv.trim() === '') return [];
            const lines = csv.trim().split('\n');
            const headers = lines[0].split(',');
            const data = [];
            
            for (let i = 1; i < lines.length; i++) {
                const obj = {};
                const currentLine = lines[i].split(',');
                
                for (let j = 0; j < headers.length; j++) {
                    obj[headers[j]] = currentLine[j];
                }
                data.push(obj);
            }
            
            return data;
        }

        const codecarbonData = parseCSV(codecarbonCSV);
        const carbontrackerData = parseCSV(carbontrackerCSV);
        
        console.log('CodeCarbon data length:', codecarbonData.length);
        console.log('CarbonTracker data length:', carbontrackerData.length);
        console.log('CarbonTracker sample:', carbontrackerData[0]);
        
        // Use CodeCarbon as primary data source for overview
        const data = codecarbonData;

        // Process data by model - flexible to handle both project_name and model_name
        function groupByModel(data) {
            const groups = {};
            data.forEach(row => {
                const model = row.project_name || row.model_name;  // Support both column names
                if (!groups[model]) {
                    groups[model] = [];
                }
                groups[model].push(row);
            });
            return groups;
        }

        const modelGroups = groupByModel(data);

        // Calculate statistics
        function calculateStats(data) {
            const stats = {
                totalExperiments: data.length,
                totalEnergy: 0,
                totalEmissions: 0,
                totalDuration: 0
            };

            data.forEach(row => {
                if (row.energy_consumed_wh && row.energy_consumed_wh.trim() !== '') {
                    stats.totalEnergy += parseFloat(row.energy_consumed_wh);
                }
                if (row.emissions_g && row.emissions_g.trim() !== '') {
                    stats.totalEmissions += parseFloat(row.emissions_g);
                }
                stats.totalDuration += parseFloat(row.duration) || 0;
            });

            return stats;
        }

        const overallStats = calculateStats(data);

        // Update summary cards
        document.getElementById('totalExperiments').textContent = overallStats.totalExperiments;
        document.getElementById('totalEnergy').innerHTML = overallStats.totalEnergy.toFixed(2) + '<span class="card-unit">Wh</span>';
        document.getElementById('totalEmissions').innerHTML = overallStats.totalEmissions.toFixed(3) + '<span class="card-unit">g</span>';
        document.getElementById('totalDuration').innerHTML = (overallStats.totalDuration / 3600).toFixed(2) + '<span class="card-unit">hrs</span>';

        // Update system info
        const firstRow = data[0];
        document.getElementById('cpuModel').textContent = firstRow.cpu_model;
        document.getElementById('gpuModel').textContent = firstRow.gpu_model;
        document.getElementById('cpuCount').textContent = firstRow.cpu_count + ' cores';
        document.getElementById('ramSize').textContent = firstRow.ram_total_size + ' GB';
        document.getElementById('location').textContent = firstRow.country_name + ', ' + firstRow.region;
        document.getElementById('pythonVersion').textContent = firstRow.python_version;
        document.getElementById('reportDate').textContent = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });

        // Chart.js default configuration
        Chart.defaults.font.family = '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
        Chart.defaults.color = '#666';

        // Model colors
        const modelColors = {
            'IMDB_Transformer': 'rgba(102, 126, 234, 0.8)',
            'IMDB_LogReg': 'rgba(118, 75, 162, 0.8)',
            'IMDB_CNN': 'rgba(237, 100, 166, 0.8)'
        };

        const modelBorderColors = {
            'IMDB_Transformer': 'rgba(102, 126, 234, 1)',
            'IMDB_LogReg': 'rgba(118, 75, 162, 1)',
            'IMDB_CNN': 'rgba(237, 100, 166, 1)'
        };

        // Energy by Model Chart - use AVERAGES over runs
        const modelNames = Object.keys(modelGroups);
        const energyByModel = modelNames.map(model => {
            const rows = modelGroups[model].filter(row => row.energy_consumed_wh && row.energy_consumed_wh.trim() !== '');
            const total = rows.reduce((sum, row) => sum + parseFloat(row.energy_consumed_wh), 0);
            return rows.length > 0 ? total / rows.length : 0;
        });

        new Chart(document.getElementById('energyChart'), {
            type: 'bar',
            data: {
                labels: modelNames.map(m => m.replace('IMDB_', '')),
                datasets: [{
                    label: 'Energy Consumed (Wh)',
                    data: energyByModel,
                    backgroundColor: modelNames.map(m => modelColors[m]),
                    borderColor: modelNames.map(m => modelBorderColors[m]),
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        callbacks: {
                            label: (context) => `Avg Energy: ${context.parsed.y.toFixed(4)} Wh`
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: { display: true, text: 'Average Energy (Wh)' }
                    }
                }
            }
        });

        // Emissions by Model Chart - use AVERAGES over runs
        const emissionsByModel = modelNames.map(model => {
            const rows = modelGroups[model].filter(row => row.emissions_g && row.emissions_g.trim() !== '');
            const total = rows.reduce((sum, row) => sum + parseFloat(row.emissions_g), 0);
            return rows.length > 0 ? total / rows.length : 0;
        });

        new Chart(document.getElementById('emissionsChart'), {
            type: 'bar',
            data: {
                labels: modelNames.map(m => m.replace('IMDB_', '')),
                datasets: [{
                    label: 'COâ‚‚ Emissions (g)',
                    data: emissionsByModel,
                    backgroundColor: modelNames.map(m => modelColors[m]),
                    borderColor: modelNames.map(m => modelBorderColors[m]),
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        callbacks: {
                            label: (context) => `Avg COâ‚‚: ${context.parsed.y.toFixed(4)} g`
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: { display: true, text: 'Average COâ‚‚ Emissions (g)' }
                    }
                }
            }
        });

        // Duration by Model Chart - use AVERAGES over runs
        const durationByModel = modelNames.map(model => {
            const rows = modelGroups[model];
            const total = rows.reduce((sum, row) => sum + (parseFloat(row.duration) || 0), 0);
            return rows.length > 0 ? (total / rows.length) / 60 : 0;
        });

        new Chart(document.getElementById('durationChart'), {
            type: 'bar',
            data: {
                labels: modelNames.map(m => m.replace('IMDB_', '')),
                datasets: [{
                    label: 'Training Duration (min)',
                    data: durationByModel,
                    backgroundColor: modelNames.map(m => modelColors[m]),
                    borderColor: modelNames.map(m => modelBorderColors[m]),
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        callbacks: {
                            label: (context) => `Avg Duration: ${context.parsed.y.toFixed(2)} min`
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: { display: true, text: 'Average Duration (minutes)' }
                    }
                }
            }
        });

        // Power Consumption Chart
        const avgPowerByModel = modelNames.map(model => {
            const rows = modelGroups[model];
            const avgCpu = rows.reduce((sum, r) => sum + (parseFloat(r.cpu_power) || 0), 0) / rows.length;
            const avgGpu = rows.reduce((sum, r) => sum + (parseFloat(r.gpu_power) || 0), 0) / rows.length;
            const avgRam = rows.reduce((sum, r) => sum + (parseFloat(r.ram_power) || 0), 0) / rows.length;
            return { cpu: avgCpu, gpu: avgGpu, ram: avgRam };
        });

        new Chart(document.getElementById('powerChart'), {
            type: 'bar',
            data: {
                labels: modelNames.map(m => m.replace('IMDB_', '')),
                datasets: [
                    {
                        label: 'CPU Power',
                        data: avgPowerByModel.map(p => p.cpu),
                        backgroundColor: 'rgba(255, 99, 132, 0.7)',
                        borderColor: 'rgba(255, 99, 132, 1)',
                        borderWidth: 2
                    },
                    {
                        label: 'GPU Power',
                        data: avgPowerByModel.map(p => p.gpu),
                        backgroundColor: 'rgba(54, 162, 235, 0.7)',
                        borderColor: 'rgba(54, 162, 235, 1)',
                        borderWidth: 2
                    },
                    {
                        label: 'RAM Power',
                        data: avgPowerByModel.map(p => p.ram),
                        backgroundColor: 'rgba(75, 192, 192, 0.7)',
                        borderColor: 'rgba(75, 192, 192, 1)',
                        borderWidth: 2
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    tooltip: {
                        callbacks: {
                            label: (context) => `${context.dataset.label}: ${context.parsed.y.toFixed(4)} W`
                        }
                    }
                },
                scales: {
                    x: { stacked: false },
                    y: {
                        stacked: false,
                        beginAtZero: true,
                        title: { display: true, text: 'Average Power (W)' }
                    }
                }
            }
        });

        // Emissions per Run Charts - one for each model
        const logregRuns = modelGroups['IMDB_LogReg'] || [];
        const cnnRuns = modelGroups['IMDB_CNN'] || [];
        const transformerRuns = modelGroups['IMDB_Transformer'] || [];
        
        // Group CarbonTracker data by model
        const ctModelGroups = groupByModel(carbontrackerData);
        const ctLogregRuns = ctModelGroups['IMDB_Logreg'] || [];
        const ctCnnRuns = ctModelGroups['IMDB_Cnn'] || [];
        const ctTransformerRuns = ctModelGroups['IMDB_Transformer'] || [];
        
        console.log('CT Model Groups:', Object.keys(ctModelGroups));
        console.log('CT LogReg runs:', ctLogregRuns.length);
        console.log('CT CNN runs:', ctCnnRuns.length);
        console.log('CT Transformer runs:', ctTransformerRuns.length);

        // LogReg Emissions per Run
        if (logregRuns.length > 0) {
            const codecarbonEmissions = logregRuns.map(r => parseFloat(r.emissions_g) || 0);
            const carbontrackerEmissions = ctLogregRuns.map(r => parseFloat(r.co2_g_adjusted) || 0);
            
            console.log('LogReg - CodeCarbon emissions:', codecarbonEmissions);
            console.log('LogReg - CarbonTracker emissions:', carbontrackerEmissions);
            
            const datasets = [
                {
                    label: 'CodeCarbon',
                    data: codecarbonEmissions,
                    backgroundColor: 'rgba(118, 75, 162, 0.2)',
                    borderColor: 'rgba(118, 75, 162, 1)',
                    borderWidth: 3,
                    fill: true,
                    tension: 0.3,
                    pointRadius: 5,
                    pointHoverRadius: 7,
                    pointBackgroundColor: 'rgba(118, 75, 162, 1)',
                    pointBorderColor: '#fff',
                    pointBorderWidth: 2
                }
            ];
            
            if (carbontrackerEmissions.length > 0) {
                datasets.push({
                    label: 'CarbonTracker (PUE-adjusted)',
                    data: carbontrackerEmissions,
                    backgroundColor: 'rgba(255, 152, 0, 0.2)',
                    borderColor: 'rgba(255, 152, 0, 1)',
                    borderWidth: 3,
                    fill: true,
                    tension: 0.3,
                    pointRadius: 5,
                    pointHoverRadius: 7,
                    pointBackgroundColor: 'rgba(255, 152, 0, 1)',
                    pointBorderColor: '#fff',
                    pointBorderWidth: 2
                });
            }
            
            new Chart(document.getElementById('logregEmissionsChart'), {
                type: 'line',
                data: {
                    labels: logregRuns.map((_, i) => `Run ${i + 1}`),
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: (context) => `${context.dataset.label}: ${context.parsed.y.toFixed(6)} g`
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: { display: true, text: 'COâ‚‚ Emissions (g)' }
                        }
                    }
                }
            });
        }

        // CNN Emissions per Run
        if (cnnRuns.length > 0) {
            const codecarbonEmissions = cnnRuns.map(r => parseFloat(r.emissions_g) || 0);
            const carbontrackerEmissions = ctCnnRuns.map(r => parseFloat(r.co2_g_adjusted) || 0);
            
            const datasets = [
                {
                    label: 'CodeCarbon',
                    data: codecarbonEmissions,
                    backgroundColor: 'rgba(237, 100, 166, 0.2)',
                    borderColor: 'rgba(237, 100, 166, 1)',
                    borderWidth: 3,
                    fill: true,
                    tension: 0.3,
                    pointRadius: 5,
                    pointHoverRadius: 7,
                    pointBackgroundColor: 'rgba(237, 100, 166, 1)',
                    pointBorderColor: '#fff',
                    pointBorderWidth: 2
                }
            ];
            
            if (carbontrackerEmissions.length > 0) {
                datasets.push({
                    label: 'CarbonTracker (PUE-adjusted)',
                    data: carbontrackerEmissions,
                    backgroundColor: 'rgba(255, 152, 0, 0.2)',
                    borderColor: 'rgba(255, 152, 0, 1)',
                    borderWidth: 3,
                    fill: true,
                    tension: 0.3,
                    pointRadius: 5,
                    pointHoverRadius: 7,
                    pointBackgroundColor: 'rgba(255, 152, 0, 1)',
                    pointBorderColor: '#fff',
                    pointBorderWidth: 2
                });
            }
            
            new Chart(document.getElementById('cnnEmissionsChart'), {
                type: 'line',
                data: {
                    labels: cnnRuns.map((_, i) => `Run ${i + 1}`),
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: (context) => `${context.dataset.label}: ${context.parsed.y.toFixed(6)} g`
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: { display: true, text: 'COâ‚‚ Emissions (g)' }
                        }
                    }
                }
            });
        }

        // Transformer Emissions per Run
        if (transformerRuns.length > 0) {
            const codecarbonEmissions = transformerRuns.map(r => parseFloat(r.emissions_g) || 0);
            const carbontrackerEmissions = ctTransformerRuns.map(r => parseFloat(r.co2_g_adjusted) || 0);
            
            const datasets = [
                {
                    label: 'CodeCarbon',
                    data: codecarbonEmissions,
                    backgroundColor: 'rgba(102, 126, 234, 0.2)',
                    borderColor: 'rgba(102, 126, 234, 1)',
                    borderWidth: 3,
                    fill: true,
                    tension: 0.3,
                    pointRadius: 5,
                    pointHoverRadius: 7,
                    pointBackgroundColor: 'rgba(102, 126, 234, 1)',
                    pointBorderColor: '#fff',
                    pointBorderWidth: 2
                }
            ];
            
            if (carbontrackerEmissions.length > 0) {
                datasets.push({
                    label: 'CarbonTracker (PUE-adjusted)',
                    data: carbontrackerEmissions,
                    backgroundColor: 'rgba(255, 152, 0, 0.2)',
                    borderColor: 'rgba(255, 152, 0, 1)',
                    borderWidth: 3,
                    fill: true,
                    tension: 0.3,
                    pointRadius: 5,
                    pointHoverRadius: 7,
                    pointBackgroundColor: 'rgba(255, 152, 0, 1)',
                    pointBorderColor: '#fff',
                    pointBorderWidth: 2
                });
            }
            
            new Chart(document.getElementById('transformerEmissionsChart'), {
                type: 'line',
                data: {
                    labels: transformerRuns.map((_, i) => `Run ${i + 1}`),
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: (context) => `${context.dataset.label}: ${context.parsed.y.toFixed(6)} g`
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: { display: true, text: 'COâ‚‚ Emissions (g)' }
                        }
                    }
                }
            });
        }

        // ====================================================================
        // PERFORMANCE METRICS VISUALIZATIONS
        // ====================================================================

        const logregMetrics = parseCSV(logregMetricsCSV);
        const cnnMetrics = parseCSV(cnnMetricsCSV);
        const transformerMetrics = parseCSV(transformerMetricsCSV);

        console.log('LogReg metrics:', logregMetrics.length);
        console.log('CNN metrics:', cnnMetrics.length);
        console.log('Transformer metrics:', transformerMetrics.length);

        // Individual Model Performance Charts
        function createPerformanceChart(canvasId, metricsData, modelName, color) {
            if (!metricsData || metricsData.length === 0) return;

            const labels = metricsData.map((_, i) => `Run ${i + 1}`);
            const testAccuracy = metricsData.map(m => parseFloat(m.test_accuracy) * 100);
            const testF1 = metricsData.map(m => parseFloat(m.test_f1) * 100);

            new Chart(document.getElementById(canvasId), {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Performance - Accuracy',
                            data: testAccuracy,
                            borderColor: color,
                            backgroundColor: color.replace('1)', '0.1)'),
                            borderWidth: 3,
                            tension: 0.3,
                            pointRadius: 6,
                            pointHoverRadius: 8
                        },
                        {
                            label: 'Performance - F1 Score',
                            data: testF1,
                            borderColor: color.replace('rgba', 'rgba').replace('1)', '0.8)'),
                            backgroundColor: 'transparent',
                            borderWidth: 3,
                            tension: 0.3,
                            pointRadius: 6,
                            pointHoverRadius: 8,
                            pointStyle: 'rect'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: true, position: 'top' },
                        tooltip: {
                            callbacks: {
                                label: (context) => `${context.dataset.label}: ${context.parsed.y.toFixed(2)}%`
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: 80,
                            max: 94,
                            title: { display: true, text: 'Score (%)' }
                        }
                    }
                }
            });
        }

        createPerformanceChart('logregPerformanceChart', logregMetrics, 'Logistic Regression', 'rgba(118, 75, 162, 1)');
        createPerformanceChart('cnnPerformanceChart', cnnMetrics, 'CNN', 'rgba(237, 100, 166, 1)');
        createPerformanceChart('transformerPerformanceChart', transformerMetrics, 'Transformer', 'rgba(102, 126, 234, 1)');

        // Cross-Model Comparison Charts
        function getAverage(arr) {
            return arr.reduce((sum, val) => sum + val, 0) / arr.length;
        }

        const modelComparisonData = [];
        if (logregMetrics.length > 0) {
            modelComparisonData.push({
                name: 'LogReg',
                testAccuracy: getAverage(logregMetrics.map(m => parseFloat(m.test_accuracy) * 100)),
                testF1: getAverage(logregMetrics.map(m => parseFloat(m.test_f1) * 100)),
                color: 'rgba(118, 75, 162, 0.8)'
            });
        }
        if (cnnMetrics.length > 0) {
            modelComparisonData.push({
                name: 'CNN',
                testAccuracy: getAverage(cnnMetrics.map(m => parseFloat(m.test_accuracy) * 100)),
                testF1: getAverage(cnnMetrics.map(m => parseFloat(m.test_f1) * 100)),
                color: 'rgba(237, 100, 166, 0.8)'
            });
        }
        if (transformerMetrics.length > 0) {
            modelComparisonData.push({
                name: 'Transformer',
                testAccuracy: getAverage(transformerMetrics.map(m => parseFloat(m.test_accuracy) * 100)),
                testF1: getAverage(transformerMetrics.map(m => parseFloat(m.test_f1) * 100)),
                color: 'rgba(102, 126, 234, 0.8)'
            });
        }

        // Accuracy Comparison Chart
        if (modelComparisonData.length > 0) {
            new Chart(document.getElementById('accuracyComparisonChart'), {
                type: 'bar',
                data: {
                    labels: modelComparisonData.map(m => m.name),
                    datasets: [{
                        label: 'Average Test Accuracy',
                        data: modelComparisonData.map(m => m.testAccuracy),
                        backgroundColor: modelComparisonData.map(m => m.color),
                        borderColor: modelComparisonData.map(m => m.color.replace('0.8)', '1)')),
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: (context) => `Accuracy: ${context.parsed.y.toFixed(2)}%`
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: 75,
                            max: 95,
                            title: { display: true, text: 'Test Accuracy (%)' }
                        }
                    }
                }
            });

            // F1 Comparison Chart
            new Chart(document.getElementById('f1ComparisonChart'), {
                type: 'bar',
                data: {
                    labels: modelComparisonData.map(m => m.name),
                    datasets: [{
                        label: 'Average Test F1 Score',
                        data: modelComparisonData.map(m => m.testF1),
                        backgroundColor: modelComparisonData.map(m => m.color),
                        borderColor: modelComparisonData.map(m => m.color.replace('0.8)', '1)')),
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: (context) => `F1 Score: ${context.parsed.y.toFixed(2)}%`
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: 75,
                            max: 95,
                            title: { display: true, text: 'Test F1 Score (%)' }
                        }
                    }
                }
            });
        }

        // Emissions vs Performance Correlation Charts
        function mergeEmissionsAndMetrics(metricsData, modelName) {
            const projectName = `IMDB_${modelName}`;
            const emissionsForModel = data.filter(row => row.project_name === projectName);
            
            const merged = [];
            for (let i = 0; i < Math.min(metricsData.length, emissionsForModel.length); i++) {
                merged.push({
                    emissions: parseFloat(emissionsForModel[i].emissions_g),
                    testAccuracy: parseFloat(metricsData[i].test_accuracy) * 100,
                    testF1: parseFloat(metricsData[i].test_f1) * 100,
                    energy: parseFloat(emissionsForModel[i].energy_consumed_wh),
                    modelName: modelName
                });
            }
            return merged;
        }

        const allCorrelationData = [];
        if (logregMetrics.length > 0) {
            allCorrelationData.push(...mergeEmissionsAndMetrics(logregMetrics, 'LogReg'));
        }
        if (cnnMetrics.length > 0) {
            allCorrelationData.push(...mergeEmissionsAndMetrics(cnnMetrics, 'CNN'));
        }
        if (transformerMetrics.length > 0) {
            allCorrelationData.push(...mergeEmissionsAndMetrics(transformerMetrics, 'Transformer'));
        }

        const colorMap = {
            'LogReg': 'rgba(118, 75, 162, 0.7)',
            'CNN': 'rgba(237, 100, 166, 0.7)',
            'Transformer': 'rgba(102, 126, 234, 0.7)'
        };

        // Emissions vs Accuracy Scatter
        if (allCorrelationData.length > 0) {
            const groupedByModel = {};
            allCorrelationData.forEach(d => {
                if (!groupedByModel[d.modelName]) {
                    groupedByModel[d.modelName] = [];
                }
                groupedByModel[d.modelName].push({ x: d.emissions, y: d.testAccuracy });
            });

            const datasets = Object.keys(groupedByModel).map(model => ({
                label: model,
                data: groupedByModel[model],
                backgroundColor: colorMap[model],
                borderColor: colorMap[model].replace('0.7)', '1)'),
                pointRadius: 8,
                pointHoverRadius: 10
            }));

            new Chart(document.getElementById('emissionsVsAccuracyChart'), {
                type: 'scatter',
                data: { datasets: datasets },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: true, position: 'top' },
                        tooltip: {
                            callbacks: {
                                label: (context) => `${context.dataset.label}: ${context.parsed.y.toFixed(2)}% @ ${context.parsed.x.toFixed(4)}g COâ‚‚`
                            }
                        }
                    },
                    scales: {
                        x: {
                            title: { display: true, text: 'COâ‚‚ Emissions (g)' }
                        },
                        y: {
                            beginAtZero: false,
                            min: 75,
                            max: 95,
                            title: { display: true, text: 'Test Accuracy (%)' }
                        }
                    }
                }
            });

            // Emissions vs F1 Scatter
            const f1GroupedByModel = {};
            allCorrelationData.forEach(d => {
                if (!f1GroupedByModel[d.modelName]) {
                    f1GroupedByModel[d.modelName] = [];
                }
                f1GroupedByModel[d.modelName].push({ x: d.emissions, y: d.testF1 });
            });

            const f1Datasets = Object.keys(f1GroupedByModel).map(model => ({
                label: model,
                data: f1GroupedByModel[model],
                backgroundColor: colorMap[model],
                borderColor: colorMap[model].replace('0.7)', '1)'),
                pointRadius: 8,
                pointHoverRadius: 10
            }));

            new Chart(document.getElementById('emissionsVsF1Chart'), {
                type: 'scatter',
                data: { datasets: f1Datasets },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: true, position: 'top' },
                        tooltip: {
                            callbacks: {
                                label: (context) => `${context.dataset.label}: ${context.parsed.y.toFixed(2)}% @ ${context.parsed.x.toFixed(4)}g COâ‚‚`
                            }
                        }
                    },
                    scales: {
                        x: {
                            title: { display: true, text: 'COâ‚‚ Emissions (g)' }
                        },
                        y: {
                            beginAtZero: false,
                            min: 75,
                            max: 95,
                            title: { display: true, text: 'Test F1 Score (%)' }
                        }
                    }
                }
            });

            // Energy Efficiency Chart (Accuracy per Watt-hour)
            const efficiencyData = [];
            if (logregMetrics.length > 0) {
                const avgAccuracy = getAverage(logregMetrics.map(m => parseFloat(m.test_accuracy) * 100));
                const avgEnergy = getAverage(allCorrelationData.filter(d => d.modelName === 'LogReg').map(d => d.energy));
                efficiencyData.push({
                    name: 'LogReg',
                    efficiency: avgAccuracy / avgEnergy,
                    color: 'rgba(118, 75, 162, 0.8)'
                });
            }
            if (cnnMetrics.length > 0) {
                const avgAccuracy = getAverage(cnnMetrics.map(m => parseFloat(m.test_accuracy) * 100));
                const avgEnergy = getAverage(allCorrelationData.filter(d => d.modelName === 'CNN').map(d => d.energy));
                efficiencyData.push({
                    name: 'CNN',
                    efficiency: avgAccuracy / avgEnergy,
                    color: 'rgba(237, 100, 166, 0.8)'
                });
            }
            if (transformerMetrics.length > 0) {
                const avgAccuracy = getAverage(transformerMetrics.map(m => parseFloat(m.test_accuracy) * 100));
                const avgEnergy = getAverage(allCorrelationData.filter(d => d.modelName === 'Transformer').map(d => d.energy));
                efficiencyData.push({
                    name: 'Transformer',
                    efficiency: avgAccuracy / avgEnergy,
                    color: 'rgba(102, 126, 234, 0.8)'
                });
            }

            if (efficiencyData.length > 0) {
                new Chart(document.getElementById('efficiencyChart'), {
                    type: 'bar',
                    data: {
                        labels: efficiencyData.map(d => d.name),
                        datasets: [{
                            label: 'Efficiency (Accuracy % / Wh)',
                            data: efficiencyData.map(d => d.efficiency),
                            backgroundColor: efficiencyData.map(d => d.color),
                            borderColor: efficiencyData.map(d => d.color.replace('0.8)', '1)')),
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false },
                            tooltip: {
                                callbacks: {
                                    label: (context) => `Efficiency: ${context.parsed.y.toFixed(2)} accuracy%/Wh`
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: { display: true, text: 'Accuracy % per Watt-hour' }
                            }
                        }
                    }
                });
            }
        }
    </script>
</body>
</html>